{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/admin/Desktop/recreate_coffee/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\r\n\r\ndeclare global {\r\n  // eslint-disable-next-line no-var\r\n  var prismaGlobal: PrismaClient | undefined;\r\n}\r\n\r\nexport const prisma =\r\n  global.prismaGlobal ||\r\n  new PrismaClient({\r\n    log: process.env.NODE_ENV === \"development\" ? [\"query\", \"error\", \"warn\"] : [\"error\"],\r\n  });\r\n\r\nif (process.env.NODE_ENV !== \"production\") global.prismaGlobal = prisma;\r\n"],"names":[],"mappings":";;;;AAAA;;AAOO,MAAM,SACX,OAAO,YAAY,IACnB,IAAI,6IAAY,CAAC;IACf,KAAK,uCAAyC;QAAC;QAAS;QAAS;KAAO,GAAG;AAC7E;AAEF,wCAA2C,OAAO,YAAY,GAAG","debugId":null}},
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/admin/Desktop/recreate_coffee/src/app/api/products/route.ts"],"sourcesContent":["// app/api/products/route.ts\r\nimport { NextResponse } from \"next/server\";\r\nimport { prisma } from \"@/lib/prisma\";\r\n\r\nexport async function GET() {\r\n  const items = await prisma.product.findMany({\r\n    include: { productSizes: true },\r\n    orderBy: { id: \"asc\" },\r\n  });\r\n\r\n  const data = items.map((p) => {\r\n    const sizes = p.productSizes || [];\r\n    // стратегия дефолта: сначала ищем 's', если нет — берём самый дешёвый\r\n    const byS = sizes.find((s) => s.key === \"s\");\r\n    const cheapest =\r\n      sizes.length > 0\r\n        ? sizes.reduce((min, s) => (s.priceCents < min.priceCents ? s : min), sizes[0])\r\n        : null;\r\n    const def = byS || cheapest;\r\n\r\n    return {\r\n      id: p.id,\r\n      name: p.name,\r\n      description: p.description,\r\n      category: p.category,\r\n      image: p.image,\r\n      sizes: sizes.map((s) => ({\r\n        key: s.key,\r\n        label: s.label,\r\n        priceCents: s.priceCents,\r\n        discountPriceCents: s.discountPriceCents ?? null,\r\n      })),\r\n      // ВЫРАВНИВАЕМ list-цену с модалкой:\r\n      defaultSizeKey: def?.key ?? null,\r\n      priceCents: def?.priceCents ?? p.priceCents, // карточка будет показывать эту цену\r\n      discountPriceCents: def?.discountPriceCents ?? p.discountPriceCents ?? null,\r\n    };\r\n  });\r\n\r\n  return NextResponse.json({ data });\r\n}\r\n"],"names":[],"mappings":"AAAA,4BAA4B;;;;;AAC5B;AACA;;;AAEO,eAAe;IACpB,MAAM,QAAQ,MAAM,gIAAM,CAAC,OAAO,CAAC,QAAQ,CAAC;QAC1C,SAAS;YAAE,cAAc;QAAK;QAC9B,SAAS;YAAE,IAAI;QAAM;IACvB;IAEA,MAAM,OAAO,MAAM,GAAG,CAAC,CAAC;QACtB,MAAM,QAAQ,EAAE,YAAY,IAAI,EAAE;QAClC,sEAAsE;QACtE,MAAM,MAAM,MAAM,IAAI,CAAC,CAAC,IAAM,EAAE,GAAG,KAAK;QACxC,MAAM,WACJ,MAAM,MAAM,GAAG,IACX,MAAM,MAAM,CAAC,CAAC,KAAK,IAAO,EAAE,UAAU,GAAG,IAAI,UAAU,GAAG,IAAI,KAAM,KAAK,CAAC,EAAE,IAC5E;QACN,MAAM,MAAM,OAAO;QAEnB,OAAO;YACL,IAAI,EAAE,EAAE;YACR,MAAM,EAAE,IAAI;YACZ,aAAa,EAAE,WAAW;YAC1B,UAAU,EAAE,QAAQ;YACpB,OAAO,EAAE,KAAK;YACd,OAAO,MAAM,GAAG,CAAC,CAAC,IAAM,CAAC;oBACvB,KAAK,EAAE,GAAG;oBACV,OAAO,EAAE,KAAK;oBACd,YAAY,EAAE,UAAU;oBACxB,oBAAoB,EAAE,kBAAkB,IAAI;gBAC9C,CAAC;YACD,oCAAoC;YACpC,gBAAgB,KAAK,OAAO;YAC5B,YAAY,KAAK,cAAc,EAAE,UAAU;YAC3C,oBAAoB,KAAK,sBAAsB,EAAE,kBAAkB,IAAI;QACzE;IACF;IAEA,OAAO,+QAAY,CAAC,IAAI,CAAC;QAAE;IAAK;AAClC","debugId":null}}]
}