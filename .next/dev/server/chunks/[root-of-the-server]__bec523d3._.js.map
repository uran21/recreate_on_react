{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/recreate/recreate_on_react/src/server/jwt.ts"],"sourcesContent":["import jwt from \"jsonwebtoken\";\r\n\r\nconst JWT_SECRET = process.env.JWT_SECRET || \"dev_secret_fallback\";\r\n\r\nexport type JwtPayload = { id: number; login: string; role: string };\r\n\r\nexport function signJwt(payload: JwtPayload, days = 7) {\r\n  return jwt.sign(payload, JWT_SECRET, { expiresIn: `${days}d` });\r\n}\r\n\r\nexport function verifyJwt(token: string): JwtPayload | null {\r\n  try { return jwt.verify(token, JWT_SECRET) as JwtPayload; }\r\n  catch { return null; }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAItC,SAAS,QAAQ,OAAmB,EAAE,OAAO,CAAC;IACnD,OAAO,kJAAG,CAAC,IAAI,CAAC,SAAS,YAAY;QAAE,WAAW,GAAG,KAAK,CAAC,CAAC;IAAC;AAC/D;AAEO,SAAS,UAAU,KAAa;IACrC,IAAI;QAAE,OAAO,kJAAG,CAAC,MAAM,CAAC,OAAO;IAA2B,EAC1D,OAAM;QAAE,OAAO;IAAM;AACvB","debugId":null}},
    {"offset": {"line": 95, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/recreate/recreate_on_react/src/app/api/session/sync/route.ts"],"sourcesContent":["// app/api/session/sync/route.ts\r\nimport { NextResponse } from \"next/server\";\r\nimport { verifyJwt } from \"@/server/jwt\";\r\nexport const runtime = \"nodejs\";\r\n\r\nconst COOKIE_NAME = \"authToken\";\r\n\r\nexport async function POST(req: Request) {\r\n  const auth = req.headers.get(\"authorization\") || \"\";\r\n  const token = auth.startsWith(\"Bearer \") ? auth.slice(7) : \"\";\r\n\r\n  if (!token) {\r\n    const res = NextResponse.json(\r\n      { ok: false, error: \"No token\" },\r\n      { status: 401 }\r\n    );\r\n    res.cookies.set(COOKIE_NAME, \"\", {\r\n      httpOnly: true,\r\n      sameSite: \"lax\",\r\n      secure: process.env.NODE_ENV === \"production\",\r\n      path: \"/\",\r\n      maxAge: 0,\r\n    });\r\n    return res;\r\n  }\r\n\r\n  const payload = verifyJwt(token);\r\n  if (!payload) {\r\n    const res = NextResponse.json(\r\n      { ok: false, error: \"Invalid token\" },\r\n      { status: 401 }\r\n    );\r\n    res.cookies.set(COOKIE_NAME, \"\", {\r\n      httpOnly: true,\r\n      sameSite: \"lax\",\r\n      secure: process.env.NODE_ENV === \"production\",\r\n      path: \"/\",\r\n      maxAge: 0,\r\n    });\r\n    return res;\r\n  }\r\n\r\n  const res = NextResponse.json({ ok: true, role: payload.role ?? null });\r\n  res.cookies.set(COOKIE_NAME, token, {\r\n    httpOnly: true,\r\n    sameSite: \"lax\",\r\n    secure: process.env.NODE_ENV === \"production\",\r\n    path: \"/\",\r\n    maxAge: 60 * 60 * 24 * 7,\r\n  });\r\n  return res;\r\n}\r\n\r\nexport async function DELETE() {\r\n  const res = NextResponse.json({ ok: true });\r\n  res.cookies.set(COOKIE_NAME, \"\", {\r\n    httpOnly: true,\r\n    sameSite: \"lax\",\r\n    secure: process.env.NODE_ENV === \"production\",\r\n    path: \"/\",\r\n    maxAge: 0,\r\n  });\r\n  return res;\r\n}\r\n"],"names":[],"mappings":"AAAA,gCAAgC;;;;;;;;;AAChC;AACA;;;AACO,MAAM,UAAU;AAEvB,MAAM,cAAc;AAEb,eAAe,KAAK,GAAY;IACrC,MAAM,OAAO,IAAI,OAAO,CAAC,GAAG,CAAC,oBAAoB;IACjD,MAAM,QAAQ,KAAK,UAAU,CAAC,aAAa,KAAK,KAAK,CAAC,KAAK;IAE3D,IAAI,CAAC,OAAO;QACV,MAAM,MAAM,gJAAY,CAAC,IAAI,CAC3B;YAAE,IAAI;YAAO,OAAO;QAAW,GAC/B;YAAE,QAAQ;QAAI;QAEhB,IAAI,OAAO,CAAC,GAAG,CAAC,aAAa,IAAI;YAC/B,UAAU;YACV,UAAU;YACV,QAAQ,oDAAyB;YACjC,MAAM;YACN,QAAQ;QACV;QACA,OAAO;IACT;IAEA,MAAM,UAAU,IAAA,mIAAS,EAAC;IAC1B,IAAI,CAAC,SAAS;QACZ,MAAM,MAAM,gJAAY,CAAC,IAAI,CAC3B;YAAE,IAAI;YAAO,OAAO;QAAgB,GACpC;YAAE,QAAQ;QAAI;QAEhB,IAAI,OAAO,CAAC,GAAG,CAAC,aAAa,IAAI;YAC/B,UAAU;YACV,UAAU;YACV,QAAQ,oDAAyB;YACjC,MAAM;YACN,QAAQ;QACV;QACA,OAAO;IACT;IAEA,MAAM,MAAM,gJAAY,CAAC,IAAI,CAAC;QAAE,IAAI;QAAM,MAAM,QAAQ,IAAI,IAAI;IAAK;IACrE,IAAI,OAAO,CAAC,GAAG,CAAC,aAAa,OAAO;QAClC,UAAU;QACV,UAAU;QACV,QAAQ,oDAAyB;QACjC,MAAM;QACN,QAAQ,KAAK,KAAK,KAAK;IACzB;IACA,OAAO;AACT;AAEO,eAAe;IACpB,MAAM,MAAM,gJAAY,CAAC,IAAI,CAAC;QAAE,IAAI;IAAK;IACzC,IAAI,OAAO,CAAC,GAAG,CAAC,aAAa,IAAI;QAC/B,UAAU;QACV,UAAU;QACV,QAAQ,oDAAyB;QACjC,MAAM;QACN,QAAQ;IACV;IACA,OAAO;AACT","debugId":null}}]
}