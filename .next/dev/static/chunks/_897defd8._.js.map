{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/recreate/recreate_on_react/src/lib/auth.ts"],"sourcesContent":["\"use client\";\r\n\r\nexport type LoginPayload = { login: string; password: string };\r\nexport type User = {\r\n  id: number; login: string; role: string;\r\n  city?: string; street?: string; houseNumber?: number; paymentMethod?: string; createdAt?: string;\r\n};\r\n\r\nexport const reLogin = /^[A-Za-z][A-Za-z0-9]{2,}$/;\r\nexport const rePassword = /^(?=.*[^\\w\\s]).{6,}$/;\r\n\r\nexport function isLoggedIn() {\r\n  try { return !!localStorage.getItem(\"authToken\"); } catch { return false; }\r\n}\r\nexport function getUser(): User | null {\r\n  try { return JSON.parse(localStorage.getItem(\"user\") || \"null\"); } catch { return null; }\r\n}\r\nexport function signOut() {\r\n  try {\r\n    localStorage.removeItem(\"authToken\");\r\n    localStorage.removeItem(\"user\");\r\n    window.dispatchEvent(new Event(\"auth:logout\"));\r\n    window.dispatchEvent(new Event(\"cart:updated\"));\r\n  } catch {}\r\n}\r\n\r\nexport async function loginViaApi(payload: LoginPayload) {\r\n  const res = await fetch(\"/api/auth/login\", {\r\n    method: \"POST\",\r\n    headers: { accept: \"application/json\", \"Content-Type\": \"application/json\" },\r\n    body: JSON.stringify(payload),\r\n  });\r\n  const data = await res.json();\r\n  if (!res.ok) throw new Error(data?.error || `HTTP ${res.status}`);\r\n  return data as { data: { access_token: string; user: User } };\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;AAQO,MAAM,UAAU;AAChB,MAAM,aAAa;AAEnB,SAAS;IACd,IAAI;QAAE,OAAO,CAAC,CAAC,aAAa,OAAO,CAAC;IAAc,EAAE,OAAM;QAAE,OAAO;IAAO;AAC5E;AACO,SAAS;IACd,IAAI;QAAE,OAAO,KAAK,KAAK,CAAC,aAAa,OAAO,CAAC,WAAW;IAAS,EAAE,OAAM;QAAE,OAAO;IAAM;AAC1F;AACO,SAAS;IACd,IAAI;QACF,aAAa,UAAU,CAAC;QACxB,aAAa,UAAU,CAAC;QACxB,OAAO,aAAa,CAAC,IAAI,MAAM;QAC/B,OAAO,aAAa,CAAC,IAAI,MAAM;IACjC,EAAE,OAAM,CAAC;AACX;AAEO,eAAe,YAAY,OAAqB;IACrD,MAAM,MAAM,MAAM,MAAM,mBAAmB;QACzC,QAAQ;QACR,SAAS;YAAE,QAAQ;YAAoB,gBAAgB;QAAmB;QAC1E,MAAM,KAAK,SAAS,CAAC;IACvB;IACA,MAAM,OAAO,MAAM,IAAI,IAAI;IAC3B,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM,MAAM,SAAS,CAAC,KAAK,EAAE,IAAI,MAAM,EAAE;IAChE,OAAO;AACT","debugId":null}},
    {"offset": {"line": 63, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/recreate/recreate_on_react/src/app/signin/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useMemo, useState } from \"react\";\r\nimport { useRouter, useSearchParams } from \"next/navigation\";\r\nimport { loginViaApi, reLogin, rePassword } from \"@/lib/auth\";\r\n\r\ntype FieldErrs = { login?: string; password?: string; };\r\n\r\nexport default function SignInPage() {\r\n  const router = useRouter();\r\n  const sp = useSearchParams();\r\n  const nextUrl = useMemo(() => sp.get(\"next\"), [sp]);\r\n\r\n  const [login, setLogin] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [errs, setErrs] = useState<FieldErrs>({});\r\n  const [busy, setBusy] = useState(false);\r\n  const [toast, setToast] = useState<{ msg: string; ok: boolean } | null>(null);\r\n\r\n  const canSubmit = reLogin.test(login.trim()) && rePassword.test(password);\r\n\r\n  useEffect(() => { setToast(null); }, [login, password]);\r\n\r\n  const submit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!canSubmit) {\r\n      setErrs({\r\n        login: reLogin.test(login.trim()) ? \"\" :\r\n          \"Login must start with a letter and contain only English letters and numbers (min 3)\",\r\n        password: rePassword.test(password) ? \"\" :\r\n          \"Password must be ≥6 and contain at least 1 special character\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    setBusy(true);\r\n    setErrs({});\r\n    setToast(null);\r\n    try {\r\n      const res = await loginViaApi({ login: login.trim(), password });\r\n      const token = res?.data?.access_token;\r\n      const user  = res?.data?.user ?? {};\r\n      if (!token) throw new Error(\"No access token\");\r\n\r\n      localStorage.setItem(\"authToken\", token);\r\n      localStorage.setItem(\"user\", JSON.stringify(user));\r\n\r\n      window.dispatchEvent(new Event(\"auth:login\"));\r\n      window.dispatchEvent(new Event(\"cart:updated\"));\r\n\r\n      setToast({ msg: \"Login successful\", ok: true });\r\n\r\n      setTimeout(() => {\r\n        if (nextUrl) router.push(nextUrl);\r\n        else router.push(\"/menu\");\r\n      }, 500);\r\n    } catch (err: any) {\r\n      const msg = String(err?.message || \"Sign-in failed\");\r\n      if (/invalid/i.test(msg) || /401/.test(msg)) {\r\n        setErrs({ password: \"Incorrect login or password\" });\r\n      }\r\n      setToast({ msg, ok: false });\r\n    } finally {\r\n      setBusy(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <main className=\"container auth\">\r\n      <h1>Sign In</h1>\r\n      <form onSubmit={submit} noValidate>\r\n        <div className=\"field\">\r\n          <label className=\"label\" htmlFor=\"login\">Login</label>\r\n          <input\r\n            className={`input ${errs.login ? \"is-invalid\" : \"\"}`}\r\n            id=\"login\"\r\n            autoComplete=\"username\"\r\n            value={login}\r\n            onChange={(e) => setLogin(e.target.value)}\r\n            aria-invalid={!!errs.login}\r\n          />\r\n          <div className=\"err\">{errs.login || \"\"}</div>\r\n        </div>\r\n\r\n        <div className=\"field\">\r\n          <label className=\"label\" htmlFor=\"password\">Password</label>\r\n          <input\r\n            className={`input ${errs.password ? \"is-invalid\" : \"\"}`}\r\n            id=\"password\"\r\n            type=\"password\"\r\n            autoComplete=\"current-password\"\r\n            value={password}\r\n            onChange={(e) => setPassword(e.target.value)}\r\n            aria-invalid={!!errs.password}\r\n          />\r\n          <div className=\"err\">{errs.password || \"\"}</div>\r\n        </div>\r\n\r\n        <div className=\"btn-row\">\r\n          <button className=\"btn-signin\" type=\"submit\" disabled={!canSubmit || busy}>\r\n            {busy ? \"Signing in…\" : \"Sign in\"}\r\n          </button>\r\n        </div>\r\n\r\n        {!!toast && (\r\n          <div className={`toast ${toast.ok ? \"toast--ok\" : \"toast--err\"}`} aria-live=\"polite\">\r\n            {toast.msg}\r\n          </div>\r\n        )}\r\n      </form>\r\n    </main>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 292, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/recreate/recreate_on_react/node_modules/next/navigation.js"],"sourcesContent":["module.exports = require('./dist/client/components/navigation')\n"],"names":[],"mappings":"AAAA,OAAO,OAAO","ignoreList":[0],"debugId":null}}]
}